## 아이템 67 - 최적화는 신중히 하라

최적화는 섣불리 진행하면 좋은 결과보다 **해로운 결과**로 이어지기 쉽다.

따라서, 프로그램이 우선 좋은 아키텍처를 가질 수 있도록 한 이후에나 최적화를 고려해야 한다.

<br/><br/>

## 마음 깊이 새겨야 할 최적화 격언.

```
맹목적인 어리석음을 포함해 그 어떤 핑계보다 효율성이라는 이름 아래 행해진 컴퓨팅 죄악이 더 많다
- 윌리엄 울프(Wulf72) -

자그마한 효율성은 모두 잊자. 섣부른 최적화가 만약의 근원이다.
- 도널드 크누스(Knuth74) -
```

<br/><br/>

## 최적화를 할 때는 다음 두 규칙.

```
첫 번째, 하지마라.

두 번째, (전문가 한정) 아직 하지 마라.
```

완전히 명백하고 최적화되지 않은 해법을 찾을 때까지는 하지 마라.

(최적화 시도 전후로 성능을 측정하라.)

<br/><br/>

## 빠른 프로그램보다는 좋은 프로그램을 작성.

- 성능 때문에 견고한 구조를 희생하지 말자.

- 좋은 프로그램이지만 원하는 성능이 나오지 않는다면 그 아키텍처 자체가 최적화할 수 있는 길을 안내해줄 것이다.

- 프로그램을 완성할 때까지 성능 문제를 무시하라는 의미는 아니고, 

    구현상의 문제는 나중에 최적화해 해결할 수 있지만, 아키텍처의 결함이 성능을 제한하는 상황이라면 
    
    시스템 전체를 다시 작성하지 않고는 해결하기 불가능할 수 있다.

<br/><br/>    

## 성능을 제한하는 설계를 피하라.

- 완성 후 변경하기가 가장 어려운 설계 요소는 바로 컴포넌트나 외부 시스템과의 소통 방식이라고 한다. 

    (API, 네트워크 프로토콜, 영구 저장용 데이터 포맷 등)


- 완성 후에는 변경하기 어렵거나 불가능할 수 있으며, 동시에 시스템 성능을 심각하게 제한할 수 있다.

<br/><br/>  

## 성능을 위해 API를 왜곡하는건 매우 안 좋은 생각이다.

다행히 잘 설계된 API는 성능도 좋은 게 보통이다.

API를 왜곡하도록 만든 성능 문제는 해당 플랫폼이나 아랫단 소프트웨어의 다음 버전에서 

사라질 수도 있지만, 왜곡된 API를 지원하는데 따르는 고통은 계속 된다고 한다.

<br/>

신중하게 설계하여 깨끗하고 명확한 구조를 갖춘 프로그램을

완성한 다음에야 최적화를 고려해볼 차례가 온다는 것이다.


<br/><br/>

## 최적화를 위해서 프로파일링 도구 사용법을 배워두자.

자바는 특히 작성된 코드로부터 CPU 명령어까지의 추상화 격차가 크기 때문에 성능 변화를 예측하기 힘들다고 한다.

<br/><br/>

## 전체 정리

빠른 프로그램을 작성하려 안달하지 말자. 

좋은 프로그램을 작성하다 보면 성능은 따라오기 마련이다. 

하지만 시스템을 설계할 때, 특히 API, 네트워크 프로토콜, 영구 저장용 데이터 포맷을 설계할 때는 성능을 염두에 두어야 한다.

<br/>

시스템 구현을 완료했다면 이제 성능을 측정해보라. 

충분히 빠르면 그것으로 끝나고, 아니라면 프로파일러를 사용해 문제의 원인이 되는 지점을 찾아 최적화를 수행하라.