## Item 57 : 지역변수의 범위를 최소화하라
### Conclusion
될수 있으면 지역변수는 **필요할 때** 선언과 동시에 초기화 하여 사용하라.  
메서드를 작게 유지하라.  
런타임 사이드이펙트에서 당신을 자유롭게 하리라.  

### In case
과거 C와 같은 절차적 프로그래밍 언어에서는 선언부가 따로 있고, 사용되거나 구현되는 위치가 따로 있었다.  
이는 메소드에 사용된 모든 변수를 한눈에 볼수 있다는 장점이 있고,   
컴파일러가 연속적인 블록의 변수에 대한 메모리 할당에 도움을 줄수 있기 때문이었다.  
더 이전으로 간다면 컴파일러의 파서의 복잡성 때문에 그렇게 해야만 했었고, 자바랑은 크게 관계가 없다.

자바는 객체의 할당이 간편하고, 고성능의 gc가 있기 때문에 그렇게 해야할 이유가 전혀 없으며,  
오히려 유지보수하기 좋은 클린한 코드를 작성하기 위해서는 지역변수는 '가장 처음 쓰일때 선언하고 초기화' 해야한다.

모든 변수를 한눈에 볼수 없다는 단점이 있지만, 이것은 메소드의 범위를 목적에 맞게 단 하나의 기능에 집중하며 작게 유지한다면 크게 문제되는 일은 아니다.

미리 선언하는 지역변수는 사용될 시점에 초기화가 되었는지 알기 힘들기때문에(또한 분기가 존재한다면) 런타임에 문제를 일으킬수도 있다.

하지만 여기도 예외는 있으니, try-catch문에서의 사용이다.  
객체의 초기화나 사용시에 예외를 던져야 한다면 try 블록 바로 위쪽에 선언하는 방식이 좋은 practice가 될수 있을것이다.
![](https://raw.githubusercontent.com/mycode01/linkimages/master/effective_java/efj_item57_01.png)  
위 스크린샷은 100% 부합하는 케이스는 아니다. 이렇게 사용할것이라면 선언부가 try블록안에 들어오는게 맞지만, catch블록 아래에 editor 객체를 더 사용할것이라고 가정한다면 이런식으로 사용해야한다는 뜻이다.

---

![](https://raw.githubusercontent.com/mycode01/linkimages/master/effective_java/efj_item57_02.png)  
반복자(컬렉션)의 요소인 s는 for 블록 안에서만 참조가 가능한 지역변수이다.

---

![](https://raw.githubusercontent.com/mycode01/linkimages/master/effective_java/efj_item57_03.png)  
책에는 사소하지만 while문보다 for문에 의한 스코프 한정이 조금 더 낫다는 예시를 보여준다.
주로 테스트코드 작성시 copy&paste 하면서 자주 하는 실수인데, while문이 참조하는 반복자는 while블록 바깥에 있어야 하기 때문이다.

---

![](https://raw.githubusercontent.com/mycode01/linkimages/master/effective_java/efj_item57_04.png)  
또, for 문이 가진 문법을 이용한 지역변수의 범위를 한정짓는 방법이다.  
여러 지역변수가 같은 참조 범위를 가져야 할때 사용할수 있다.


## in my opinion
거의 모든 지역변수는 선언과 동시에 초기화해야한다. 초기화에 필요한 정보가 충분하지 않다면 충분해질때까지 선언을 **미뤄야한다**.(p344)  
예전 프로젝트에서 불변객체를 적극적으로 이용해서 코드를 작성해보자라고 합의를 했을때 이런 질문을 받은적이 있다.  

가변객체를 이용하지 않으면(setter를 가진 클래스) 프리젠테이션 레이어로 전달할 dto는 어떻게 만들어야 하나요?  
리턴해야할 데이터의 소스가 한곳이 아니라면 당연히 이런 생각을 할수있다.  
앞서 나온 내용에서 배운대로 컴패니언 객체나, (일부값이 기본값을 가진다면)빌더 패턴을 이용할수 있다.

